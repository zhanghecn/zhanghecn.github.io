<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>汇编条件跳转判断 | ASM</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="ASM教程">
    
    <link rel="preload" href="/asm/dist/assets/css/0.styles.bcf31e2a.css" as="style"><link rel="preload" href="/asm/dist/assets/js/app.6634fcdc.js" as="script"><link rel="preload" href="/asm/dist/assets/js/2.c8a9966a.js" as="script"><link rel="preload" href="/asm/dist/assets/js/10.bcf60c5c.js" as="script"><link rel="prefetch" href="/asm/dist/assets/js/11.548c431c.js"><link rel="prefetch" href="/asm/dist/assets/js/12.1e9ff982.js"><link rel="prefetch" href="/asm/dist/assets/js/13.cee08286.js"><link rel="prefetch" href="/asm/dist/assets/js/14.0c34b073.js"><link rel="prefetch" href="/asm/dist/assets/js/15.55afd9f3.js"><link rel="prefetch" href="/asm/dist/assets/js/16.5fc6bad5.js"><link rel="prefetch" href="/asm/dist/assets/js/17.70286e2b.js"><link rel="prefetch" href="/asm/dist/assets/js/18.8ef81a29.js"><link rel="prefetch" href="/asm/dist/assets/js/19.3afd398b.js"><link rel="prefetch" href="/asm/dist/assets/js/20.5d3c78e4.js"><link rel="prefetch" href="/asm/dist/assets/js/21.f610ef5f.js"><link rel="prefetch" href="/asm/dist/assets/js/22.ee117ac9.js"><link rel="prefetch" href="/asm/dist/assets/js/23.c03a1a4d.js"><link rel="prefetch" href="/asm/dist/assets/js/24.7537d8de.js"><link rel="prefetch" href="/asm/dist/assets/js/3.f5310743.js"><link rel="prefetch" href="/asm/dist/assets/js/4.bc7cf726.js"><link rel="prefetch" href="/asm/dist/assets/js/5.d250cb53.js"><link rel="prefetch" href="/asm/dist/assets/js/6.8779df89.js"><link rel="prefetch" href="/asm/dist/assets/js/7.cf8be782.js"><link rel="prefetch" href="/asm/dist/assets/js/8.f2edada3.js"><link rel="prefetch" href="/asm/dist/assets/js/9.fb834f7f.js">
    <link rel="stylesheet" href="/asm/dist/assets/css/0.styles.bcf31e2a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/asm/dist/" class="home-link router-link-active"><!----> <span class="site-name">ASM</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/asm/dist/" class="nav-link">
  主页
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/asm/dist/" class="nav-link">
  主页
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/asm/dist/AsmSummarize.html" class="sidebar-link">asm教程概述</a></li><li><a href="/asm/dist/visualstudio/" class="sidebar-link">Visual Studio</a></li><li><a href="/asm/dist/cplus/" class="sidebar-link">c++基础</a></li><li><a href="/asm/dist/cplus/cClass.html" class="sidebar-link">C++的类</a></li><li><a href="/asm/dist/cplus/cAdvanced.html" class="sidebar-link">C++ 进阶</a></li><li><a href="/asm/dist/cplus/dll.html" class="sidebar-link">DLL</a></li><li><a href="/asm/dist/cplus/CC.html" class="sidebar-link">C#</a></li><li><a href="/asm/dist/asm/" aria-current="page" class="sidebar-link">asm概述</a></li><li><a href="/asm/dist/asm/basic.html" class="sidebar-link">asm基础</a></li><li><a href="/asm/dist/asm/operator.html" class="sidebar-link">asm运算符和指令</a></li><li><a href="/asm/dist/asm/stack.html" class="sidebar-link">堆栈与函数</a></li><li><a href="/asm/dist/asm/bool.html" aria-current="page" class="active sidebar-link">汇编条件跳转判断</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/asm/dist/asm/bool.html#基本介绍" class="sidebar-link">基本介绍</a></li><li class="sidebar-sub-header"><a href="/asm/dist/asm/bool.html#and-和-not" class="sidebar-link">AND 和 NOT</a></li><li class="sidebar-sub-header"><a href="/asm/dist/asm/bool.html#or" class="sidebar-link">OR</a></li><li class="sidebar-sub-header"><a href="/asm/dist/asm/bool.html#xor" class="sidebar-link">XOR</a></li><li class="sidebar-sub-header"><a href="/asm/dist/asm/bool.html#test" class="sidebar-link">TEST</a></li><li class="sidebar-sub-header"><a href="/asm/dist/asm/bool.html#cmp" class="sidebar-link">CMP</a></li><li class="sidebar-sub-header"><a href="/asm/dist/asm/bool.html#标志位的灵活设置" class="sidebar-link">标志位的灵活设置</a></li><li class="sidebar-sub-header"><a href="/asm/dist/asm/bool.html#标志位与条件跳转" class="sidebar-link">标志位与条件跳转</a></li><li class="sidebar-sub-header"><a href="/asm/dist/asm/bool.html#条件循环" class="sidebar-link">条件循环</a></li></ul></li><li><a href="/asm/dist/asm/function.html" class="sidebar-link">高级函数过程</a></li><li><a href="/asm/dist/asm/float.html" class="sidebar-link">浮点数</a></li><li><a href="/asm/dist/asm/example.html" class="sidebar-link">汇编示例</a></li><li><a href="/asm/dist/ddt/" class="sidebar-link">弹弹堂</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="汇编条件跳转判断"><a href="#汇编条件跳转判断" class="header-anchor">#</a> 汇编条件跳转判断</h1> <h2 id="基本介绍"><a href="#基本介绍" class="header-anchor">#</a> 基本介绍</h2> <p>汇编有4种布尔指令</p> <ul><li>AND 进行并的操作</li> <li>OR 或的操作</li> <li>XOR 异或操作</li> <li>NOT 非操作</li> <li>TEST 与操作 破坏性的AND操作</li></ul> <p>bool指令影响零的标记位(ZF Zero Flag)(0为true 1为false)</p> <p>回顾一下</p> <ol><li>结果为0的时,ZF=1 (Zero Flag)</li> <li>最高位有进位时,CF=1 ( Carry Flag)</li> <li>计算结果有负数时,SF=1 (Sign Flag)</li> <li>产生结果超出有符号数时,OF=1(overflow flag)</li> <li>结果二进制的1出现偶数,PF=1(parity flag)</li></ol> <h2 id="and-和-not"><a href="#and-和-not" class="header-anchor">#</a> AND 和 NOT</h2> <p>and指令总是会清除标志位 OF (overflow flag) 和 CF(carry flag)</p> <p><strong>使用and 符号将小写转换为大写</strong></p> <ul><li>大写字母距离小写字母差20h 也就 32(10进制)</li> <li>转换二进制也就是 10 0000 补码也就是   1110 1100</li> <li>我们从小写转换大写也就是二进制要减去10 0000</li> <li>AND符号的特性就是 <code>1 and 1 = 1</code> <code>1 and 0 = 0</code></li></ul> <ol><li>我们以1个字节站8个bit来相减看看</li></ol> <div class="language-c extra-class"><pre class="language-c"><code>  <span class="token number">0110</span> <span class="token number">0001</span>
<span class="token operator">+</span> <span class="token number">1110</span> <span class="token number">0000</span>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token number">1</span> <span class="token number">0100</span>  <span class="token number">0001</span>   
 去掉高位
<span class="token operator">=</span> <span class="token number">0100</span>  <span class="token number">0001</span>  <span class="token operator">=</span> <span class="token number">41</span>h
</code></pre></div><ol start="2"><li>但如果用AND和NOT呢？</li></ol> <div class="language-c extra-class"><pre class="language-c"><code>     <span class="token number">0</span>  <span class="token number">1</span>  <span class="token number">1</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">1</span> <span class="token operator">=</span> <span class="token number">61</span>h <span class="token punctuation">(</span><span class="token char">'a'</span><span class="token punctuation">)</span>
AND  <span class="token number">1</span>  <span class="token number">1</span>  <span class="token number">0</span>  <span class="token number">1</span>  <span class="token number">1</span>  <span class="token number">1</span>  <span class="token number">1</span>  <span class="token number">1</span>  <span class="token punctuation">(</span> NOT <span class="token number">0010</span> <span class="token number">0000</span> 反码<span class="token punctuation">)</span>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
     <span class="token number">0</span>  <span class="token number">1</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">0</span>  <span class="token number">1</span> <span class="token operator">=</span> <span class="token number">41</span>h <span class="token punctuation">(</span><span class="token char">'A'</span><span class="token punctuation">)</span>
</code></pre></div><p>由于刚好20h=32 是2的幂次方数 <code>1 00 0000</code>
那么减去 <code>1 00 0000</code> 且保留 后面的位数就很容易了</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <div class="language-c extra-class"><pre class="language-c"><code>使用and 符号 用反码就很容易保留后面位数的<span class="token number">1</span><span class="token punctuation">(</span>两个<span class="token number">1</span>为<span class="token number">1</span><span class="token punctuation">)</span>
<span class="token number">1</span> <span class="token number">11</span> <span class="token number">1101</span> <span class="token operator">&amp;</span> <span class="token number">0</span> <span class="token number">11</span> <span class="token number">1111</span><span class="token punctuation">(</span> NOT <span class="token number">0010</span> <span class="token number">0000</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span> <span class="token number">11</span> <span class="token number">1101</span>  
</code></pre></div></div> <ol start="3"><li>汇编代码如下</li></ol> <div class="language-c extra-class"><pre class="language-c"><code>uCase proc
   <span class="token punctuation">;</span>获取反码
	mov rbx<span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">;</span>
	not rbx<span class="token punctuation">;</span>
	


    <span class="token punctuation">;</span>and 去掉 <span class="token number">1</span> <span class="token number">00</span> <span class="token number">0000</span> 
	mov al<span class="token punctuation">,</span>cl<span class="token punctuation">;</span>
	and eax<span class="token punctuation">,</span>ebx<span class="token punctuation">;</span>
	
	ret<span class="token punctuation">;</span>
uCase endp<span class="token punctuation">;</span>
</code></pre></div><h2 id="or"><a href="#or" class="header-anchor">#</a> OR</h2> <p>or 就是遇到1则为1
如  0 1001 or 0 1100 = 0 1101</p> <p>汇编指令</p> <div class="language-c extra-class"><pre class="language-c"><code>mov al<span class="token punctuation">,</span><span class="token number">0</span> <span class="token number">1001</span><span class="token punctuation">;</span>
or al<span class="token punctuation">,</span><span class="token number">01100</span><span class="token punctuation">;</span>
</code></pre></div><p>标志位情况:</p> <ul><li>al &gt; 0  : SF = 0  ZF = 0</li> <li>al = 0  : SF = 0  ZF =1</li> <li>al &lt; 0  : SF = 1  ZF = 0</li></ul> <h2 id="xor"><a href="#xor" class="header-anchor">#</a> XOR</h2> <p>异或 就是不一样 为 1 一样为 0
如:</p> <div class="language-c extra-class"><pre class="language-c"><code>mov al<span class="token punctuation">,</span><span class="token number">011</span>b<span class="token punctuation">;</span>
xor al<span class="token punctuation">,</span><span class="token number">011</span>b<span class="token punctuation">;</span> <span class="token comment">//结果为000</span>

xor al<span class="token punctuation">,</span><span class="token number">011</span>b<span class="token punctuation">;</span> <span class="token comment">//结果 000 xor 011 = 011</span>
</code></pre></div><h2 id="test"><a href="#test" class="header-anchor">#</a> TEST</h2> <p>与and 不同的是，不会修改操作数 只会修改标志位</p> <h2 id="cmp"><a href="#cmp" class="header-anchor">#</a> CMP</h2> <p>cmp是个比较指令，也算个减法操作数,但并不会影响目标操作数的值</p> <p><code>cmp target,source</code></p> <p>其计算结果还会修改标志位:</p> <ul><li>target &lt; source : ZF = 0 CF(负数的1是反码所以进位) = 1</li> <li>target &gt; source : ZF = 0 CF = 0</li> <li>target = source : ZF = 1 CF = 0</li></ul> <p>示例:</p> <div class="language-c extra-class"><pre class="language-c"><code>mov eax<span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">;</span>
cmp eax<span class="token punctuation">,</span><span class="token number">999</span><span class="token punctuation">;</span> <span class="token comment">//ZF=0 CF = 1</span>
</code></pre></div><div class="language-c extra-class"><pre class="language-c"><code>mov eax<span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">;</span>
cmp eax<span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">;</span> <span class="token comment">//ZF=1 CF = 0</span>
</code></pre></div><div class="language-c extra-class"><pre class="language-c"><code>mov eax<span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">;</span>
cmp eax<span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">;</span> <span class="token comment">//ZF=0 CF = 0</span>
</code></pre></div><h2 id="标志位的灵活设置"><a href="#标志位的灵活设置" class="header-anchor">#</a> 标志位的灵活设置</h2> <div class="language-c extra-class"><pre class="language-c"><code>resetCPU proc
mov eax<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">;</span>
not eax<span class="token punctuation">;</span> <span class="token comment">//PF = 1 </span>
test eax<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// ZF = 1 SF = 0</span>
or eax<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// ZF = 0   SF = 1</span>
xor eax<span class="token punctuation">,</span><span class="token number">0ffff</span>ffffh<span class="token punctuation">;</span>  <span class="token comment">//ZF = 0 SF = 0 CF = 0</span>
stc<span class="token punctuation">;</span> <span class="token comment">//CF = 1</span>
clc<span class="token punctuation">;</span> <span class="token comment">//CF = 0</span>

mov al<span class="token punctuation">,</span><span class="token number">7f</span>h<span class="token punctuation">;</span> <span class="token comment">// 0111 1111  127</span>
inc al<span class="token punctuation">;</span> <span class="token comment">//1000 0000       -128    AF = 1 CF =1 OF =1</span>
or eax<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// OF=0</span>

resetCPU endp<span class="token punctuation">;</span>
</code></pre></div><h2 id="标志位与条件跳转"><a href="#标志位与条件跳转" class="header-anchor">#</a> 标志位与条件跳转</h2> <p>汇编语言中没有明显的逻辑判断执行,但可通过标志位来实现条件跳转
一般来说可以通过 cmp,and,or,sub,add,xor 等来修改标志位来实现逻辑跳转</p> <ol><li>标志位跳转语句如下:</li></ol> <ul><li>JZ  :JMP ZF(zero flag)=1 跳转</li> <li>JNZ :JMP ZF(zero flag)=0 跳转</li> <li>JC  :JMP CF(carry flag 进位)=1 跳转</li> <li>JNC  :JMP CF(carry flag 非进位)=1 跳转</li> <li>JO   :JMP OF(overflow) = 1</li> <li>JNO  :JMP OF(overflow) = 0</li> <li>JS   :JMP SF(sign) = 1</li> <li>JNS   :JMP SF(sign) = 0</li> <li>JP    :JMP PF(parity) = 1</li> <li>JNP   :JMP PF(parity) = 0</li></ul> <ol start="2"><li>其中还有相等性位</li></ol> <ul><li>JL   :JMP LESS ZF!=0 小于跳转</li> <li>JG   :JMP GREATER ZF!=0 大于跳转</li> <li>JE   :JMP equals 相等跳转</li> <li>JNE  :JMP 不相等跳转</li> <li>JECXZ :JMP ECX = 0 跳转</li> <li>JGE  :grater equals 大于等于跳转</li> <li>JLE  : less than equals 小于等于</li></ul> <ol start="3"><li>示例
求3个数中最大数:</li></ol> <div class="language-c extra-class"><pre class="language-c"><code><span class="token punctuation">.</span>code
max proc
<span class="token punctuation">;</span>参数放入堆栈
push rcx<span class="token punctuation">;</span>
push rdx<span class="token punctuation">;</span>
push r8<span class="token punctuation">;</span>

pop rdx<span class="token punctuation">;</span> c
pop rbx<span class="token punctuation">;</span> b 
pop rax<span class="token punctuation">;</span> a

cmp rax<span class="token punctuation">,</span>rbx<span class="token punctuation">;</span>
jg L1<span class="token punctuation">;</span>  b <span class="token operator">&gt;</span> a

<span class="token punctuation">;</span>b大于a AB互换
L1<span class="token operator">:</span>
 mov rcx<span class="token punctuation">,</span>rbx<span class="token punctuation">;</span> rcx用来临时存储互换
 mov rbx<span class="token punctuation">,</span>rax<span class="token punctuation">;</span>
 mov rax<span class="token punctuation">,</span>rcx<span class="token punctuation">;</span>

 cmp rax<span class="token punctuation">,</span>rcx<span class="token punctuation">;</span> c<span class="token operator">&gt;</span>a
 jg L2<span class="token punctuation">;</span>
 
<span class="token punctuation">;</span>c大于a ac互换
L2<span class="token operator">:</span>
 mov rcx<span class="token punctuation">,</span>rdx<span class="token punctuation">;</span>
 mov rdx<span class="token punctuation">,</span>rax<span class="token punctuation">;</span>
 mov rax<span class="token punctuation">,</span>rcx<span class="token punctuation">;</span>


ret<span class="token punctuation">;</span>
max endp
</code></pre></div><ol start="4"><li>示例 求数组第一个不为0的下标</li></ol> <div class="language-c extra-class"><pre class="language-c"><code>findNz proc
push rcx<span class="token punctuation">;</span>
push rdx<span class="token punctuation">;</span>

pop rcx<span class="token punctuation">;</span>计数循环
pop rsi<span class="token punctuation">;</span>数组指针

mov rax<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">;</span>下标计数

L1<span class="token operator">:</span>
  cmp dword ptr <span class="token punctuation">[</span>rsi<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">;</span>
  jnz found<span class="token punctuation">;</span> ZF<span class="token operator">=</span><span class="token number">0</span>
  inc rax<span class="token punctuation">;</span>
  add rsi<span class="token punctuation">,</span>type DWORD<span class="token punctuation">;</span>
  loop L1<span class="token punctuation">;</span>

test eax<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//ZF=1</span>
jz noFound<span class="token punctuation">;</span> 


found<span class="token operator">:</span>
	ret<span class="token punctuation">;</span> 找到的话直接返回eax下标   

noFound<span class="token operator">:</span>
	mov ax<span class="token punctuation">,</span><span class="token number">10000001</span>b<span class="token punctuation">;</span>
	movsx rax<span class="token punctuation">,</span>ax<span class="token punctuation">;</span>
	ret<span class="token punctuation">;</span>未找到返回<span class="token operator">-</span><span class="token number">1</span>

ret<span class="token punctuation">;</span>
findNz endp
</code></pre></div><h2 id="条件循环"><a href="#条件循环" class="header-anchor">#</a> 条件循环</h2> <ul><li>LOOPZ或LOOPE ZF=0跳转循环</li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/2/2022, 7:54:57 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/asm/dist/asm/stack.html" class="prev">
        堆栈与函数
      </a></span> <span class="next"><a href="/asm/dist/asm/function.html">
        高级函数过程
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/asm/dist/assets/js/app.6634fcdc.js" defer></script><script src="/asm/dist/assets/js/2.c8a9966a.js" defer></script><script src="/asm/dist/assets/js/10.bcf60c5c.js" defer></script>
  </body>
</html>
